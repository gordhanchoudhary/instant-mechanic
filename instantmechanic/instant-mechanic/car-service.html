<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instant Mechanic - Premium Car Service</title>
    <link rel="icon" href="assets/img/favicon.png">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #f59e0b;
            --accent-color: #10b981;
            --dark-color: #0f172a;
            --light-color: #f8fafc;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --white: #ffffff;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-accent: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: var(--gray-50);
            overflow-x: hidden;
        }

        /* Header */
        .header {
            background: var(--white);
            box-shadow: var(--shadow-md);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .header-top {
            background: var(--dark-color);
            color: var(--white);
            padding: 8px 0;
            font-size: 14px;
        }

        .header-top .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-info {
            display: flex;
            gap: 20px;
        }

        .header-info span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-social {
            display: flex;
            gap: 15px;
        }

        .header-social a {
            color: var(--white);
            transition: color 0.3s ease;
        }

        .header-social a:hover {
            color: var(--secondary-color);
        }

        .header-main {
            padding: 12px 0;
        }

        .header-main .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
            font-family: 'Poppins', sans-serif;
        }

        .nav {
            display: flex;
            gap: 25px;
            list-style: none;
        }

        .nav a {
            color: var(--gray-700);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav a:hover {
            color: var(--primary-color);
        }

        .nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .nav a:hover::after {
            width: 100%;
        }

        .cta-button {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
            font-size: 14px;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Main Content */
        .main-content {
            margin-top: 110px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 15px;
        }

        .progress-bar {
            width: 100%;
            max-width: 500px;
            margin-bottom: 30px;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .progress-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gray-200);
            z-index: 1;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            height: 2px;
            background: var(--gradient-primary);
            transition: width 0.5s ease;
            z-index: 2;
        }

        .step {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: var(--white);
            border: 2px solid var(--gray-200);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: var(--gray-400);
            position: relative;
            z-index: 3;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .step.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: var(--white);
            transform: scale(1.1);
        }

        .step.completed {
            background: var(--accent-color);
            border-color: var(--accent-color);
            color: var(--white);
        }

        .section-title {
            text-align: center;
            margin-bottom: 30px;
        }

        .section-title h1 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--gray-900);
            margin-bottom: 8px;
            font-family: 'Poppins', sans-serif;
        }

        .section-title p {
            font-size: 0.95rem;
            color: var(--gray-600);
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.5;
        }

        /* Content Containers */
        .content-container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Grid Container - Mobile First */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 20px;
        }

        /* Brand Cards */
        .brand-card {
            background: var(--white);
            border-radius: 15px;
            padding: 20px 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .brand-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--gradient-accent);
            opacity: 0.1;
            transition: left 0.5s ease;
        }

        .brand-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .brand-card:hover::before {
            left: 0;
        }

        .brand-card img {
            width: 50px;
            height: 50px;
            object-fit: contain;
            margin-bottom: 10px;
            transition: transform 0.3s ease;
        }

        .brand-card:hover img {
            transform: scale(1.05);
        }

        .brand-card h3 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 5px;
        }

        /* Car Cards */
        .car-card {
            background: var(--white);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
            border: 2px solid transparent;
        }

        .car-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-color);
        }

        .car-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .car-card-content {
            padding: 15px 10px;
            text-align: center;
        }

        .car-card h3 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--gray-800);
            line-height: 1.3;
        }

        /* Selected Car Display */
        .selected-car {
            background: var(--white);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            border: 2px solid var(--primary-color);
        }

        .selected-car img {
            width: 100%;
            max-width: 280px;
            height: 180px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .selected-car h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        /* Service Cards */
        .service-card {
            background: var(--white);
            border-radius: 18px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .service-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-color);
        }

        .service-header {
            background: var(--gradient-primary);
            color: var(--white);
            padding: 18px;
            position: relative;
        }

        .service-tag {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--secondary-color);
            color: var(--white);
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .service-header h3 {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .service-content {
            padding: 20px;
        }

        .service-image {
            width: 100%;
            height: 160px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .price-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }

        .original-price {
            font-size: 1rem;
            text-decoration: line-through;
            color: var(--gray-400);
        }

        .discounted-price {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .discount-badge {
            background: var(--accent-color);
            color: var(--white);
            padding: 3px 8px;
            border-radius: 8px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .service-details {
            margin-bottom: 18px;
        }

        .service-details h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 12px;
        }

        .inclusions-list {
            list-style: none;
            margin-bottom: 12px;
        }

        .inclusions-list li {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 6px;
            font-size: 0.9rem;
            color: var(--gray-700);
            line-height: 1.4;
        }

        .inclusions-list li i {
            color: var(--accent-color);
            font-size: 0.9rem;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .see-more-btn {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 6px 14px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 12px;
            font-size: 0.85rem;
        }

        .see-more-btn:hover {
            background: var(--primary-color);
            color: var(--white);
        }

        .service-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 18px;
            padding: 12px;
            background: var(--gray-50);
            border-radius: 12px;
        }

        .info-item {
            text-align: center;
            flex: 1;
        }

        .info-item i {
            color: var(--primary-color);
            font-size: 1rem;
            margin-bottom: 4px;
            display: block;
        }

        .info-item .label {
            font-size: 0.75rem;
            color: var(--gray-500);
            display: block;
            margin-bottom: 2px;
        }

        .info-item .value {
            font-weight: 600;
            color: var(--gray-800);
            font-size: 0.8rem;
        }

        .book-service-btn {
            background: var(--gradient-secondary);
            color: var(--white);
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-md);
        }

        .book-service-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        /* Loading States */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            color: var(--primary-color);
            font-size: 1rem;
        }

        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid var(--gray-200);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 12px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mobile Specific Adjustments */
        @media (max-width: 768px) {
            .header-top {
                display: none;
            }

            .header-main {
                padding: 10px 0;
            }

            .header-main .container {
                padding: 0 12px;
            }

            .logo {
                font-size: 20px;
            }

            .nav {
                display: none;
            }

            .cta-button {
                padding: 8px 16px;
                font-size: 13px;
            }

            .main-content {
                margin-top: 70px;
                padding: 15px 10px;
            }

            .section-title h1 {
                font-size: 1.5rem;
            }

            .section-title p {
                font-size: 0.9rem;
            }

            .progress-bar {
                max-width: 100%;
                margin-bottom: 25px;
            }

            .step {
                width: 30px;
                height: 30px;
                font-size: 12px;
            }

            /* Maintain 3 columns on mobile */
            .grid-container {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }

            .brand-card {
                padding: 15px 8px;
                border-radius: 12px;
            }

            .brand-card img {
                width: 40px;
                height: 40px;
                margin-bottom: 8px;
            }

            .brand-card h3 {
                font-size: 0.8rem;
                line-height: 1.2;
            }

            .car-card img {
                height: 90px;
                padding: 6px;
                background: var(--gray-50);
            }

            .car-card-content {
                padding: 12px 8px;
            }

            .car-card h3 {
                font-size: 0.8rem;
            }

            .selected-car {
                padding: 15px;
                margin-bottom: 20px;
            }

            .selected-car img {
                height: 100px;
                max-width: 160px;
                padding: 6px;
            }

            .selected-car h2 {
                font-size: 1.1rem;
            }

            .service-card {
                margin-bottom: 15px;
                border-radius: 15px;
            }

            .service-header {
                padding: 15px;
            }

            .service-header h3 {
                font-size: 1.1rem;
            }

            .service-tag {
                font-size: 0.7rem;
                padding: 3px 8px;
            }

            .service-content {
                padding: 15px;
            }

            .service-image {
                height: 140px;
            }

            .price-section {
                gap: 8px;
            }

            .original-price {
                font-size: 0.9rem;
            }

            .discounted-price {
                font-size: 1.3rem;
            }

            .service-info {
                gap: 8px;
                padding: 10px;
            }

            .info-item {
                display: flex;
                align-items: center;
                justify-content: space-between;
                text-align: left;
            }

            .info-item i {
                margin-bottom: 0;
                margin-right: 8px;
            }

            .book-service-btn {
                font-size: 0.95rem;
                padding: 11px 20px;
            }
        }

        /* Extra small screens */
        @media (max-width: 480px) {
            .main-content {
                padding: 12px 8px;
            }

            .grid-container {
                gap: 6px;
            }

            .brand-card {
                padding: 12px 6px;
            }

            .brand-card img {
                width: 35px;
                height: 35px;
            }

            .brand-card h3 {
                font-size: 0.75rem;
            }

            .section-title h1 {
                font-size: 1.3rem;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in-left {
            animation: slideInLeft 0.5s ease-out;
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .slide-in-right {
            animation: slideInRight 0.5s ease-out;
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }
    </style>

    <!-- Meta Pixel Code -->
    <script>
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      fbq('init', '479182611911558');
      fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=479182611911558&ev=PageView&noscript=1"
    /></noscript>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-info">
                    <span>
                        <i class="fas fa-phone"></i>
                        +91 9266961110
                    </span>
                    <span>
                        <i class="fas fa-map-marker-alt"></i>
                        Sector 75, Gurgaon, Haryana
                    </span>
                </div>
                <div class="header-social">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
        
        <div class="header-main">
            <div class="container">
                <a href="index.html" class="logo">Instant Mechanic</a>
                
                <nav class="nav">
                    <a href="#home">Home</a>
                    <a href="#services">Services</a>
                    <a href="#about">About</a>
                    <a href="#contact">Contact</a>
                </nav>
                
                <a href="tel:+919266961110" class="cta-button">
                    <i class="fas fa-phone"></i> Call Now
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Progress Bar -->
        <div class="progress-bar">
            <div class="progress-steps">
                <div class="progress-line" id="progressLine"></div>
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
                <div class="step" id="step4">4</div>
            </div>
        </div>

        <!-- Dynamic Content -->
        <div class="content-container">
            <!-- Section Title -->
            <div class="section-title" id="sectionTitle">
                <h1>Choose Your Car Brand</h1>
                <p>Select your car brand to get started with our premium service experience</p>
            </div>

            <!-- Brand Selection -->
            <div class="grid-container" id="brandContainer"></div>

            <!-- Car Selection -->
            <div class="grid-container hidden" id="carContainer"></div>

            <!-- Selected Car Display -->
            <div class="selected-car hidden" id="selectedCarDisplay"></div>

            <!-- Service Selection -->
            <div class="content-container hidden" id="serviceContainer"></div>

            <!-- Loading State -->
            <div class="loading hidden" id="loadingState">
                <div class="spinner"></div>
                Loading services...
            </div>
        </div>
    </main>

    <script>
        // Global variables
        let brands = [];
        let cars = [];
        let currentStep = 1;
        let selectedBrand = null;
        let selectedCar = null;

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            loadBrandData();
            loadCarData();
        });

        // Load brand data
        async function loadBrandData() {
            try {
                const response = await fetch('car_brand.json');
                brands = await response.json();
                displayBrands();
            } catch (error) {
                console.error('Error loading brands:', error);
            }
        }

        // Load car data
        async function loadCarData() {
            try {
                const response = await fetch('car.json');
                cars = await response.json();
                console.log("Car data loaded:", cars);
            } catch (error) {
                console.error('Error loading cars:', error);
            }
        }

        // Display brands
        function displayBrands() {
            const container = document.getElementById('brandContainer');
            container.innerHTML = '';
            
            brands.forEach((brand, index) => {
                const brandCard = document.createElement('div');
                brandCard.className = 'brand-card fade-in';
                brandCard.style.animationDelay = `${index * 0.1}s`;
                
                brandCard.innerHTML = `
                    <img src="${brand.brand_logo}" alt="${brand.name}" loading="lazy">
                    <h3>${brand.name}</h3>
                `;
                
                brandCard.addEventListener('click', () => selectBrand(brand));
                container.appendChild(brandCard);
            });
        }

        // Select brand
        function selectBrand(brand) {
            selectedBrand = brand;
            localStorage.setItem('selectedBrand', JSON.stringify(brand));
            
            updateProgress(2);
            updateSectionTitle('Select Your Car Model', 'Choose the specific model of your car');
            
            // Hide brand container and show loading
            document.getElementById('brandContainer').classList.add('hidden');
            document.getElementById('loadingState').classList.remove('hidden');
            
            setTimeout(() => {
                document.getElementById('loadingState').classList.add('hidden');
                displayCars(brand.id);
            }, 800);
        }

        // Display cars
        function displayCars(brandId) {
            const container = document.getElementById('carContainer');
            container.innerHTML = '';
            container.classList.remove('hidden');

            if (cars.length === 0) {
                container.innerHTML = '<p class="text-center">No car data available. Please try again.</p>';
                return;
            }

            let filteredCars = cars.filter(car => car.brand && car.brand.id === brandId);
            
            if (filteredCars.length === 0) {
                container.innerHTML = '<p class="text-center">No cars found for this brand.</p>';
                return;
            }
            
            // Remove duplicates
            let uniqueCars = [];
            let seenNames = new Set();
            
            filteredCars.forEach(car => {
                if (!seenNames.has(car.name)) {
                    seenNames.add(car.name);
                    uniqueCars.push(car);
                }
            });

            uniqueCars.forEach((car, index) => {
                const carCard = document.createElement('div');
                carCard.className = 'car-card slide-in-left';
                carCard.style.animationDelay = `${index * 0.1}s`;
                
                carCard.innerHTML = `
                    <img src="${car.image_path || 'assets/img/default-car.jpg'}" alt="${car.name}" loading="lazy" 
                         onerror="this.src='assets/img/logo.svg'">
                    <div class="car-card-content">
                        <h3>${car.name}</h3>
                    </div>
                `;
                
                carCard.addEventListener('click', () => selectCar(car));
                container.appendChild(carCard);
            });
        }

        // Select car
        function selectCar(car) {
            selectedCar = car;
            
            // Store car details
            localStorage.setItem("selectedCarId", car.car_type_id);
            localStorage.setItem("selectedCarName", car.name);
            localStorage.setItem("carImage", car.image_path);
            localStorage.setItem("brand", car.brand.name);
            localStorage.setItem("carName", car.name);
            
            updateProgress(3);
            updateSectionTitle('Your Selected Vehicle', 'Review your selection and choose a service');
            
            // Hide car container
            document.getElementById('carContainer').classList.add('hidden');
            
            // Show selected car
            displaySelectedCar(car);
            
            // Load services
            loadServices(car.car_type_id);
        }

        // Display selected car
        function displaySelectedCar(car) {
            const container = document.getElementById('selectedCarDisplay');
            container.classList.remove('hidden');
            
            const carName = `${car.brand.name} ${car.name}`;
            container.innerHTML = `
                <img src="${car.image_path}" alt="Selected Car" loading="lazy" class="fade-in">
                <h2 class="fade-in">${carName}</h2>
            `;
        }

        // Load services
        async function loadServices(carId) {
            document.getElementById('loadingState').classList.remove('hidden');
            
            const apiUrl = `https://gomechanic.app/api/v2/oauth/customer/get-services-details-by-category?car_id=${carId}&city_id=6&category_id=0&user_car_id=null`;
            
            const headers = {
                "Accept": "*/*",
                "Authorization": "Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJiNGJjM2NhZjVkMWVhOTlkYzk2YjQzM2NjYzQzMDI0ZTAyM2I0MGM2YjQ5ZjExN2JjMDk5OGY2MWU3ZDI1ZjM2MTU1YWU5ZDIxNjE2ZTc5NSIsImF1ZCI6IjMiLCJzY29wZXMiOltdLCJleHAiOjE3NjAyODQ4MDkuMCwibmJmIjoxNzU3NjkyODA5LjAsImlhdCI6MTc1NzY5MjgwOS4wLCJzdWIiOiIxNzU3NjkyODA5NTAifQ.TWVWYtySQDpuTdwJ__s96e9ghsZibmpOJp6edBRcjgJNwRyabeNWdkuemwUB_GcFpwmoApw-Fix_kFhifqM2zVJe4DZhMyRpUyYNrANRRAZvIkFYHsqP0TSrDfCcI2b2z6Shy9wt86mt8C8cJlWh0SLbw9SLOv4hmfIHZJNF2-ZPfHtepeKjWf6yXibhXt8cdlmLjiOpNe6oxQDdCBrAr7lAdWFSJF4GdgPjUW_uMlPa9Lq3w3GsGSv4DQ9TgYwGeeGdq9crcs05KcLs9AkMCwHOSyNF9ehxWoCpJ9gtXtRd8QKVyDvj7xGpna6kePUclVRw4KR7Ikt3pC4iItmdhLQWUK7SX1pNqmgHMVzUA62Vy23FVY37oBqOmGKI-9gIl_rAGxY6Ik9Qf6tiqImHRtKB1J6QRMItDq6f01-o-54CZXPlvGg3yKYG5GDfPFM0z51DpTiyWvj0PB1Vvr99zUf7S1uOgLWLXkiqn_oDwfmvH80Qo-oS5p61AJhss1l-GbgPtUQpxhibunHwrbzZkbiZIre1RwMiTmwckg4OfXaWVoVrluCx8Zp2w8SP3IAVxGFdZFGg546D_nxi00pR0-vRFRb6I3xCCYEkUftVM8CcawNy5Bcb-hI0ZbljWZkUlbkggQdBo5VmDRvJllT5zS8W-iTE-hy8pvhv7xU9QHk",
                "Content-Type": "application/json"
            };

            try {
                const response = await fetch(apiUrl, { method: "GET", headers: headers });
                const data = await response.json();
                
                document.getElementById('loadingState').classList.add('hidden');
                
                if (data.status && data.data.length > 0) {
                    const services = data.data[0].services;
                    const extractedServices = services.map(service => ({
                        name: service.name || "N/A",
                        service_tag: service.service_tag || "Every 3 Month",
                        price: service.package_details[0].strikethrough || "N/A",
                        discounted_price: service.package_details[0].total || "N/A",
                        image: getServiceImage(service.name),
                        description: service.desc_details || {},
                        inclusion: service.desc_details?.inclusion || [],
                        time_taken: service.desc_details?.time_taken || "N/A",
                        warranty: service.desc_details?.warranty || "N/A"
                    }));

                    displayServices(extractedServices);
                } else {
                    console.error("No services found in response.");
                }
            } catch (error) {
                document.getElementById('loadingState').classList.add('hidden');
                console.error("Error fetching services:", error);
                alert("Failed to fetch services. Please try again.");
            }
        }

        // Get service image
        function getServiceImage(serviceName) {
            const imageMap = {
                "Standard Service": "assets/img/standard.jpg",
                "Comprehensive Service": "assets/img/premium.jpg",
                "Basic Service": "assets/img/basic.jpg"
            };
            return imageMap[serviceName] || "assets/img/basic.jpg";
        }

        // Display services
        function displayServices(services) {
            updateProgress(4);
            updateSectionTitle('Choose Your Service', 'Select the perfect service package for your vehicle');
            
            const container = document.getElementById('serviceContainer');
            container.classList.remove('hidden');
            container.innerHTML = '';

            services.forEach((service, index) => {
                const serviceCard = document.createElement('div');
                serviceCard.className = 'service-card slide-in-right';
                serviceCard.style.animationDelay = `${index * 0.2}s`;
                
                const inclusions = Array.isArray(service.inclusion) ? service.inclusion : [];
                const visibleInclusions = inclusions.slice(0, 5);
                const hiddenInclusions = inclusions.slice(5);
                
                const discountedPrice = parseInt(service.discounted_price) + 500;
                const savings = parseInt(service.price) - discountedPrice;
                const discountPercentage = Math.round((savings / parseInt(service.price)) * 100);
                
                serviceCard.innerHTML = `
                    <div class="service-header">
                        <h3>${service.name}</h3>
                        <div class="service-tag">${service.service_tag}</div>
                    </div>
                    
                    <div class="service-content">
                        <img src="${service.image}" alt="${service.name}" class="service-image" loading="lazy">
                        
                        <div class="price-section">
                            <span class="original-price">₹${service.price}</span>
                            <span class="discounted-price">₹${discountedPrice}</span>
                            <span class="discount-badge">Save ${discountPercentage}%</span>
                        </div>
                        
                        <div class="service-details">
                            <h4><i class="fas fa-check-circle"></i> What's Included:</h4>
                            <ul class="inclusions-list">
                                ${visibleInclusions.map(item => `
                                    <li><i class="fas fa-check"></i> ${item}</li>
                                `).join('')}
                                <div class="hidden-inclusions hidden" id="more-${index}">
                                    ${hiddenInclusions.map(item => `
                                        <li><i class="fas fa-check"></i> ${item}</li>
                                    `).join('')}
                                </div>
                            </ul>
                            ${hiddenInclusions.length > 0 ? `
                                <button class="see-more-btn" onclick="toggleInclusions(${index})">
                                    <i class="fas fa-chevron-down"></i> Show More
                                </button>
                            ` : ''}
                        </div>
                        
                        <div class="service-info">
                            <div class="info-item">
                                <i class="fas fa-clock"></i>
                                <div>
                                    <span class="label">Duration</span>
                                    <span class="value">${service.time_taken}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-shield-alt"></i>
                                <div>
                                    <span class="label">Warranty</span>
                                    <span class="value">${service.warranty}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-star"></i>
                                <div>
                                    <span class="label">Rating</span>
                                    <span class="value">4.8/5</span>
                                </div>
                            </div>
                        </div>
                        
                        <button class="book-service-btn" onclick="bookService('${service.name}')">
                            <i class="fab fa-whatsapp"></i> Book Service Now
                        </button>
                    </div>
                `;
                
                container.appendChild(serviceCard);
            });
        }

        // Toggle inclusions
        function toggleInclusions(index) {
            const moreDiv = document.getElementById(`more-${index}`);
            const button = event.target;
            
            if (moreDiv.classList.contains('hidden')) {
                moreDiv.classList.remove('hidden');
                button.innerHTML = '<i class="fas fa-chevron-up"></i> Show Less';
            } else {
                moreDiv.classList.add('hidden');
                button.innerHTML = '<i class="fas fa-chevron-down"></i> Show More';
            }
        }

        // Update progress
        function updateProgress(step) {
            currentStep = step;
            
            // Update steps
            for (let i = 1; i <= 4; i++) {
                const stepElement = document.getElementById(`step${i}`);
                stepElement.classList.remove('active', 'completed');
                
                if (i < step) {
                    stepElement.classList.add('completed');
                    stepElement.innerHTML = '<i class="fas fa-check"></i>';
                } else if (i === step) {
                    stepElement.classList.add('active');
                    stepElement.innerHTML = i;
                } else {
                    stepElement.innerHTML = i;
                }
            }
            
            // Update progress line
            const progressLine = document.getElementById('progressLine');
            const width = ((step - 1) / 3) * 100;
            progressLine.style.width = `${width}%`;
        }

        // Update section title
        function updateSectionTitle(title, subtitle) {
            document.getElementById('sectionTitle').innerHTML = `
                <h1 class="fade-in">${title}</h1>
                <p class="fade-in">${subtitle}</p>
            `;
        }

        // Book service
        function bookService(serviceName) {
            const brand = localStorage.getItem("brand");
            const carName = localStorage.getItem("carName");
            
            const message = `Hi team! 👋\n\nI want to book *${serviceName}* for my *${brand} ${carName}* 🚗\n\nPlease arrange a callback 📞\n\nThank you!`;
            const phone = "9266961110";
            const whatsappURL = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
            
            // Track booking event
            if (typeof fbq !== 'undefined') {
                fbq('track', 'InitiateCheckout', {
                    content_name: serviceName,
                    content_category: 'Car Service',
                    value: 500,
                    currency: 'INR'
                });
            }
            
            window.open(whatsappURL, '_blank');
        }
    </script>
</body>
</html>
