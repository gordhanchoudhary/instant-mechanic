<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
  <title>‡§á‡§Ç‡§∏‡•ç‡§ü‡•á‡§Ç‡§ü ‡§Æ‡•à‡§ï‡•á‡§®‡§ø‡§ï - ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #2E7D32;
      --primary-light: #4CAF50;
      --primary-dark: #1B5E20;
      --success-color: #00C853;
      --danger-color: #D32F2F;
      --warning-color: #FF9800;
      --background: #F5F5F5;
      --surface: #FFFFFF;
      --text-primary: #212121;
      --text-secondary: #757575;
      --shadow: rgba(0,0,0,0.1);
      --shadow-dark: rgba(0,0,0,0.2);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: 'Noto Sans Devanagari', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }

    .container {
      max-width: 100%;
      width: 100%;
      margin: 0 auto;
      background: var(--surface);
      min-height: 100vh;
      position: relative;
      z-index: 1;
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
      color: white;
      padding: 60px 20px 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .map-button {
      position: absolute;
      top: 25px;
      right: 20px;
      background: rgba(255,255,255,0.25);
      border: 2px solid rgba(255,255,255,0.4);
      color: white;
      padding: 8px 12px;
      border-radius: 25px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      backdrop-filter: blur(10px);
      z-index: 2;
      min-height: 36px;
    }

    .map-button:hover, .map-button:active {
      background: rgba(255,255,255,0.35);
      transform: scale(0.95);
    }

    .header h1 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }

    .header p {
      font-size: 16px;
      opacity: 0.9;
      font-weight: 500;
    }

    .booking-id {
      background: rgba(255,255,255,0.25);
      padding: 10px 18px;
      border-radius: 25px;
      display: inline-block;
      margin-top: 15px;
      font-weight: 600;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.3);
      font-size: 15px;
    }

    .content {
      padding: 25px 20px 140px;
      background: var(--surface);
    }

    .detail-row {
      display: flex;
      align-items: flex-start;
      margin-bottom: 16px;
      padding: 16px;
      background: #f8f9fa;
      border-radius: 12px;
      border-left: 4px solid var(--primary-color);
      transition: all 0.3s ease;
    }

    .detail-row:hover {
      transform: translateX(4px);
      box-shadow: 0 4px 12px var(--shadow);
    }

    .detail-icon {
      width: 40px;
      height: 40px;
      margin-right: 12px;
      background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
      color: white;
    }

    .detail-content {
      flex: 1;
      min-width: 0;
    }

    .detail-label {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 4px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .detail-value {
      font-size: 16px;
      color: var(--text-primary);
      font-weight: 600;
      line-height: 1.4;
      word-wrap: break-word;
    }

    .location-link {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 700;
      transition: color 0.3s ease;
    }

    .location-link:hover {
      color: var(--primary-dark);
    }

    .status-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .status-active {
      background: #e8f5e8;
      color: var(--primary-dark);
      border: 2px solid var(--success-color);
    }

    .status-cancelled {
      background: #ffebee;
      color: var(--danger-color);
      border: 2px solid var(--danger-color);
    }

    .payment-info {
      background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);
      padding: 20px;
      border-radius: 16px;
      margin: 20px 0;
      border: 2px solid rgba(76, 175, 80, 0.2);
      position: relative;
    }

    .payment-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
      font-size: 16px;
      font-weight: 500;
    }

    .payment-row:last-child {
      margin-bottom: 0;
      border-top: 2px solid var(--primary-color);
      padding-top: 12px;
      font-weight: 800;
      font-size: 18px;
      color: var(--primary-dark);
    }

    /* Fixed bottom action area */
    .action-area {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--surface);
      padding: 16px 20px 20px;
      border-top: 1px solid #e0e0e0;
      z-index: 100;
      box-shadow: 0 -4px 20px var(--shadow);
    }

    /* Slide to Accept Container */
    .slide-container {
      position: relative;
      width: 100%;
      height: 60px;
      background: linear-gradient(135deg, var(--success-color) 0%, #00E676 100%);
      border-radius: 30px;
      margin-bottom: 12px;
      overflow: hidden;
      box-shadow: 0 4px 16px rgba(0, 200, 83, 0.3);
      user-select: none;
      -webkit-user-select: none;
      cursor: pointer;
    }

    .slide-track {
      position: absolute;
      top: 4px;
      left: 4px;
      right: 4px;
      bottom: 4px;
      background: rgba(255,255,255,0.2);
      border-radius: 26px;
      overflow: hidden;
    }

    .slide-progress {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      background: rgba(255,255,255,0.3);
      border-radius: 26px;
      width: 0%;
      transition: none;
    }

    .slide-button {
      position: absolute;
      top: 4px;
      left: 4px;
      width: 52px;
      height: 52px;
      background: white;
      border-radius: 50%;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: none;
      z-index: 10;
      touch-action: none;
    }

    .slide-button:active {
      cursor: grabbing;
    }

    .slide-text {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-weight: 800;
      font-size: 16px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      pointer-events: none;
      z-index: 5;
      white-space: nowrap;
    }

    .slide-completed .slide-text {
      color: rgba(255,255,255,0.9);
    }

    /* Cancel Button */
    .cancel-btn {
      width: 100%;
      padding: 16px 20px;
      background: #ffebee;
      border: 2px solid var(--danger-color);
      border-radius: 12px;
      font-size: 16px;
      font-weight: 700;
      color: var(--danger-color);
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-height: 52px;
    }

    .cancel-btn:active {
      transform: scale(0.98);
      background: var(--danger-color);
      color: white;
    }

    /* Loading states */
    .loading {
      opacity: 0.7;
      pointer-events: none;
    }

    .loading .slide-button::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 20px;
      border: 2px solid var(--primary-color);
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Success/Error Messages */
    .message {
      position: fixed;
      top: 20px;
      left: 20px;
      right: 20px;
      background: var(--surface);
      padding: 16px 20px;
      border-radius: 12px;
      box-shadow: 0 4px 20px var(--shadow-dark);
      z-index: 1000;
      text-align: center;
      font-weight: 600;
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s ease;
    }

    .message.show {
      opacity: 1;
      transform: translateY(0);
    }

    .message.success {
      border-left: 4px solid var(--success-color);
      color: var(--success-color);
    }

    .message.error {
      border-left: 4px solid var(--danger-color);
      color: var(--danger-color);
    }

    /* Loading skeleton */
    .skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
      border-radius: 12px;
      height: 70px;
      margin-bottom: 16px;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .error-state {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .error-state h3 {
      color: var(--danger-color);
      margin-bottom: 16px;
      font-size: 18px;
    }

    .retry-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 16px;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .retry-btn:active {
      background: var(--primary-dark);
      transform: scale(0.95);
    }

    /* Icons */
    .icon-car::before { content: 'üöó'; }
    .icon-problem::before { content: 'üîß'; }
    .icon-price::before { content: 'üí∞'; }
    .icon-location::before { content: 'üìç'; }
    .icon-agent::before { content: 'üë§'; }
    .icon-status::before { content: 'üìã'; }

    /* Mobile optimizations */
    @media (max-width: 480px) {
      .container {
        border-radius: 0;
      }

      .header {
        padding: 50px 16px 25px;
      }

      .content {
        padding: 20px 16px 120px;
      }

      .action-area {
        padding: 12px 16px 16px;
      }

      .detail-row {
        padding: 14px;
        margin-bottom: 12px;
      }

      .header h1 {
        font-size: 24px;
      }

      .map-button {
        top: 20px;
        right: 16px;
        padding: 6px 10px;
        font-size: 12px;
      }
    }

    /* Prevent zoom on double tap */
    button, input, select, textarea {
      touch-action: manipulation;
    }

    /* Pulse animation for slide container */
    .pulse {
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { box-shadow: 0 4px 16px rgba(0, 200, 83, 0.3); }
      50% { box-shadow: 0 4px 16px rgba(0, 200, 83, 0.6); }
      100% { box-shadow: 0 4px 16px rgba(0, 200, 83, 0.3); }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="#" id="mapButton" class="map-button" target="_blank" style="display: none;">
        üìç ‡§≤‡•ã‡§ï‡•á‡§∂‡§®
      </a>
      <h1>üîß ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§µ‡§ø‡§µ‡§∞‡§£</h1>
      <p>‡§á‡§Ç‡§∏‡•ç‡§ü‡•á‡§Ç‡§ü ‡§Æ‡•à‡§ï‡•á‡§®‡§ø‡§ï ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏</p>
      <div class="booking-id" id="bookingIdDisplay">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
    </div>

    <div class="content">
      <div id="loadingContent">
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
        <div class="skeleton"></div>
      </div>

      <div id="bookingContent" style="display: none;">
        <div class="detail-section">
          <div class="detail-row">
            <div class="detail-icon icon-agent"></div>
            <div class="detail-content">
              <div class="detail-label">‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡§æ ‡§®‡§æ‡§Æ</div>
              <div class="detail-value" id="agentDetails">IM comp</div>
            </div>
          </div>

          <div class="detail-row">
            <div class="detail-icon icon-status"></div>
            <div class="detail-content">
              <div class="detail-label">‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</div>
              <div class="detail-value">
                <span class="status-badge status-active" id="statusBadge">‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø</span>
              </div>
            </div>
          </div>

          <div class="detail-row">
            <div class="detail-icon icon-car"></div>
            <div class="detail-content">
              <div class="detail-label">‡§ó‡§æ‡§°‡§º‡•Ä ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</div>
              <div class="detail-value" id="carDetails">-</div>
            </div>
          </div>

          <div class="detail-row">
            <div class="detail-icon icon-problem"></div>
            <div class="detail-content">
              <div class="detail-label">‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£</div>
              <div class="detail-value" id="problemDetails">-</div>
            </div>
          </div>

          <div class="detail-row">
            <div class="detail-icon icon-location"></div>
            <div class="detail-content">
              <div class="detail-label">‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§≤‡•ã‡§ï‡•á‡§∂‡§®</div>
              <div class="detail-value">
                <a href="#" id="locationLink" class="location-link" target="_blank">
                  üìç ‡§Æ‡•à‡§™ ‡§™‡§∞ ‡§¶‡•á‡§ñ‡•á‡§Ç
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="payment-info">
          <div class="payment-row">
            <span>‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§ö‡§æ‡§∞‡•ç‡§ú:</span>
            <span id="serviceCharge">‚Çπ965 (Service Charge: ‚Çπ818 + GST: ‚Çπ147)</span>
          </div>
          <div class="payment-row">
            <span>‡§Ü‡§™‡§ï‡•ã ‡§Æ‡§ø‡§≤‡•á‡§ó‡§æ:</span>
            <span id="mechanicPayment">‚Çπ400</span>
          </div>
        </div>
      </div>

      <div id="errorContent" class="error-state" style="display: none;">
        <h3>‚ö†Ô∏è ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø</h3>
        <p>‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•Ä ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä ‡§≤‡•ã‡§° ‡§®‡§π‡•Ä‡§Ç ‡§π‡•ã ‡§∏‡§ï‡•Ä‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç‡•§</p>
        <button class="retry-btn" onclick="loadBookingData()">üîÑ ‡§¶‡•ã‡§¨‡§æ‡§∞‡§æ ‡§ï‡•ã‡§∂‡§ø‡§∂ ‡§ï‡§∞‡•á‡§Ç</button>
      </div>
    </div>
  </div>

  <!-- Fixed bottom action area -->
  <div class="action-area" id="actionArea" style="display: none;">
    <!-- Slide to Accept -->
    <div class="slide-container pulse" id="slideContainer">
      <div class="slide-track">
        <div class="slide-progress" id="slideProgress"></div>
      </div>
      <div class="slide-button" id="slideButton">
        ‚úÖ
      </div>
      <div class="slide-text" id="slideText">
        ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§ï‡§∞‡•á‡§Ç ‚Üí
      </div>
    </div>

    <!-- Cancel Button -->
    <button class="cancel-btn" id="cancelBtn">
      ‚ùå <span>‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</span>
    </button>
  </div>

  <!-- Success/Error Message -->
  <div class="message" id="messageBox"></div>

  <script>
    // Get booking ID from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const bookingId = urlParams.get('id');

    let bookingData = null;
    let isSliding = false;
    let startX = 0;
    let currentX = 0;
    let initialButtonLeft = 4;

    const slideButton = document.getElementById('slideButton');
    const slideProgress = document.getElementById('slideProgress');
    const slideContainer = document.getElementById('slideContainer');
    const slideText = document.getElementById('slideText');
    const actionArea = document.getElementById('actionArea');

    // Load booking data when page loads
    document.addEventListener('DOMContentLoaded', function() {
      if (!bookingId) {
        showError('URL ‡§Æ‡•á‡§Ç ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ID ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä');
        return;
      }
      loadBookingData();
      initializeSlider();
    });

    function loadBookingData() {
      document.getElementById('loadingContent').style.display = 'block';
      document.getElementById('bookingContent').style.display = 'none';
      document.getElementById('errorContent').style.display = 'none';
      document.getElementById('actionArea').style.display = 'none';

      // Simulate API call - replace with actual API endpoint
      fetch(`https://ai.instantmechanic.online/bot/api/bookings/${bookingId}/`)
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          bookingData = data;
          displayBookingData(data);
        })
        .catch(error => {
          console.error('Error loading booking:', error);
          // Show demo data for testing
          displayBookingData({
            id: bookingId,
            agent_name: 'IM comp',
            car: 'Maruti Swift',
            problem: 'Battery ‡§ñ‡§∞‡§æ‡§¨ ‡§π‡•à',
            location: 'https://maps.google.com/?q=28.4595,77.0266',
            price: 965,
            pending_payment_amount: 400,
            is_cancelled: false
          });
        });
    }

    function displayBookingData(data) {
      // Hide loading and show content
      document.getElementById('loadingContent').style.display = 'none';
      document.getElementById('errorContent').style.display = 'none';
      document.getElementById('bookingContent').style.display = 'block';

      // Update booking ID
      document.getElementById('bookingIdDisplay').textContent = `‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó #${data.id || bookingId}`;

      // Update car details
      document.getElementById('carDetails').textContent = data.car || '‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç';

      // Update problem details
      document.getElementById('problemDetails').textContent = data.problem || '‡§®‡§ø‡§∞‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç';

      // Update location
      const locationLink = document.getElementById('locationLink');
      const mapButton = document.getElementById('mapButton');
      
      if (data.location) {
        locationLink.href = data.location;
        locationLink.innerHTML = 'üìç ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç';
        
        // Show and set map button in header
        mapButton.href = data.location;
        mapButton.style.display = 'inline-flex';
      } else {
        locationLink.href = '#';
        locationLink.innerHTML = 'üìç ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç';
        mapButton.style.display = 'none';
      }

      // Update agent details
      document.getElementById('agentDetails').textContent = data.agent_name || '‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§Ö‡§∏‡§æ‡§á‡§® ‡§®‡§π‡•Ä‡§Ç';

      // Update status and show/hide action buttons
      const statusBadge = document.getElementById('statusBadge');
      
      if (data.is_cancelled) {
        statusBadge.textContent = '‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ';
        statusBadge.className = 'status-badge status-cancelled';
        actionArea.style.display = 'none';
      } else {
        statusBadge.textContent = '‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø';
        statusBadge.className = 'status-badge status-active';
        actionArea.style.display = 'block';
      }

      // Update payment info
      document.getElementById('serviceCharge').textContent = `‚Çπ${data.price || 965} (Service Charge: ‚Çπ${Math.round((data.price || 965) * 0.848)} + GST: ‚Çπ${Math.round((data.price || 965) * 0.152)})`;
      document.getElementById('mechanicPayment').textContent = `‚Çπ${data.pending_payment_amount || 400}`;
    }

    function showError(message) {
      document.getElementById('loadingContent').style.display = 'none';
      document.getElementById('bookingContent').style.display = 'none';
      document.getElementById('actionArea').style.display = 'none';
      document.getElementById('errorContent').style.display = 'block';
      document.querySelector('#errorContent p').textContent = message;
    }

    function showMessage(text, type = 'success') {
      const messageBox = document.getElementById('messageBox');
      messageBox.textContent = text;
      messageBox.className = `message ${type}`;
      messageBox.classList.add('show');
      
      setTimeout(() => {
        messageBox.classList.remove('show');
      }, 4000);
    }

    // Initialize slider functionality
    function initializeSlider() {
      const containerRect = slideContainer.getBoundingClientRect();
      const maxSlide = slideContainer.offsetWidth - slideButton.offsetWidth - 8; // 8px total margin

      // Touch events
      slideButton.addEventListener('touchstart', handleStart, { passive: false });
      document.addEventListener('touchmove', handleMove, { passive: false });
      document.addEventListener('touchend', handleEnd, { passive: false });

      // Mouse events
      slideButton.addEventListener('mousedown', handleStart);
      document.addEventListener('mousemove', handleMove);
      document.addEventListener('mouseup', handleEnd);

      function handleStart(e) {
        e.preventDefault();
        isSliding = true;
        
        const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
        const buttonRect = slideButton.getBoundingClientRect();
        
        startX = clientX - buttonRect.left;
        slideButton.style.transition = 'none';
        slideProgress.style.transition = 'none';
        slideContainer.classList.remove('pulse');
        
        document.body.style.overflow = 'hidden'; // Prevent scrolling while sliding
      }

      function handleMove(e) {
        if (!isSliding) return;
        e.preventDefault();

        const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
        const containerRect = slideContainer.getBoundingClientRect();
        
        currentX = clientX - containerRect.left - startX;
        currentX = Math.max(0, Math.min(currentX, maxSlide));

        const progress = (currentX / maxSlide) * 100;
        
        slideButton.style.left = `${currentX + 4}px`;
        slideProgress.style.width = `${progress}%`;

        // Update text opacity based on progress
        slideText.style.opacity = Math.max(0.2, 1 - (progress / 100));

        // Check if 70% complete
        if (progress >= 70) {
          slideContainer.classList.add('slide-completed');
          slideText.textContent = '‡§õ‡•ã‡§°‡§º‡•á‡§Ç, ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à!';
          slideButton.innerHTML = 'üéâ';
        } else {
          slideContainer.classList.remove('slide-completed');
          slideText.textContent = '‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§ï‡§∞‡•á‡§Ç ‚Üí';
          slideButton.innerHTML = '‚úÖ';
        }
      }

      function handleEnd(e) {
        if (!isSliding) return;
        isSliding = false;
        
        document.body.style.overflow = ''; // Restore scrolling

        const progress = (currentX / maxSlide) * 100;

        if (progress >= 70) {
          // Accept booking
          acceptBooking();
        } else {
          // Reset position
          slideButton.style.transition = 'left 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
          slideProgress.style.transition = 'width 0.3s cubic-bezier(0.4, 0, 0.2, 1)';
          slideButton.style.left = '4px';
          slideProgress.style.width = '0%';
          slideText.style.opacity = '1';
          slideText.textContent = '‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡•ç‡§≤‡§æ‡§á‡§° ‡§ï‡§∞‡•á‡§Ç ‚Üí';
          slideButton.innerHTML = '‚úÖ';
          slideContainer.classList.remove('slide-completed');
          
          // Add pulse back after reset
          setTimeout(() => {
            slideContainer.classList.add('pulse');
          }, 300);
        }

        currentX = 0;
      }
    }

    function acceptBooking() {
      actionArea.classList.add('loading');
      slideText.textContent = '‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡•Ä ‡§π‡•à...';
      slideButton.innerHTML = '';
      
      // Simulate API call
      setTimeout(() => {
        showMessage('‚úÖ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ó‡§à! ‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§≤‡•ã‡§ï‡•á‡§∂‡§® ‡§™‡§∞ ‡§ú‡§æ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç‡•§', 'success');
        actionArea.style.display = 'none';
        
        // Update status
        const statusBadge = document.getElementById('statusBadge');
        statusBadge.textContent = '‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ï‡•Ä ‡§ó‡§à';
        statusBadge.className = 'status-badge status-active';
      }, 2000);
    }

    function cancelBooking() {
      if (confirm('‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§µ‡§æ‡§ï‡§à ‡§á‡§∏ ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?\n\n‡§ï‡•É‡§™‡§Ø‡§æ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§Ø‡§π ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á‡•§')) {
        actionArea.classList.add('loading');
        
        // Simulate API call
        setTimeout(() => {
          showMessage('‚ùå ‡§¨‡•Å‡§ï‡§ø‡§Ç‡§ó ‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§∞ ‡§¶‡•Ä ‡§ó‡§à‡•§ ‡§è‡§ú‡•á‡§Ç‡§ü ‡§ï‡•ã ‡§∏‡•Ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø ‡§Ü‡§™ ‡§Ø‡§π ‡§∏‡§∞‡•ç‡§µ‡§ø‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á‡•§', 'error');
          actionArea.style.display = 'none';
          
          // Update status
          const statusBadge = document.getElementById('statusBadge');
          statusBadge.textContent = '‡§∞‡§¶‡•ç‡§¶ ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ';
          statusBadge.className = 'status-badge status-cancelled';
        }, 1500);
      }
    }

    // Cancel button event
    document.getElementById('cancelBtn').addEventListener('click', cancelBooking);

    // Prevent context menu on long press
    document.addEventListener('contextmenu', function(e) {
      if (e.target.closest('.slide-button') || e.target.closest('.action-area')) {
        e.preventDefault();
      }
    });

    // Add haptic feedback for touch devices
    function vibrate(pattern = 50) {
      if ('vibrate' in navigator) {
        navigator.vibrate(pattern);
      }
    }

    // Add vibration feedback to slide interactions
    slideButton.addEventListener('touchstart', () => vibrate(10));
    
    // Prevent double-tap zoom
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function (event) {
      var now = (new Date()).getTime();
      if (now - lastTouchEnd <= 300) {
        event.preventDefault();
      }
      lastTouchEnd = now;
    }, false);

    // Handle window resize
    window.addEventListener('resize', function() {
      if (isSliding) {
        // Stop sliding on resize
        isSliding = false;
        slideButton.style.left = '4px';
        slideProgress.style.width = '0%';
      }
    });
  </script>
</body>
</html>
